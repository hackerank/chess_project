{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\think\\\\Desktop\\\\Projects\\\\Chess Project\\\\frontend\\\\chess-frontend\\\\src\\\\Components\\\\GameBoard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState } from 'react';\nimport './GameBoard.css';\nimport Tile from './Tile';\nimport Referee from './Referee';\nimport { GRID_SIZE, horizontalAxis, verticalAxis } from '../constants';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst room = prompt('Enter room');\n// const room = \"default\";\n\nconst team = prompt(`Enter 'B' for black  or 'W' for white`);\nconst socket = io(`ws://192.168.29.13:8085/?room=${room}`);\nexport let piece = {\n  image: String,\n  x: Number,\n  y: Number,\n  type: String,\n  team: String,\n  enPassant: Boolean\n};\n\n// array which holds the information regarding initial chess pieces and their \nconst initialBoardState = [];\nexport const isBlack = team === 'B' ? true : false;\n\n// here we init the board state on game start\nfor (let p = 0; p < 2; p++) {\n  const teamType = p === 0 ? \"opponent\" : \"our\";\n  const type = !isBlack ? p === 0 ? \"B\" : \"W\" : p === 0 ? \"W\" : \"B\";\n  const pawns_x_cor = p === 0 ? 1 : 6;\n  const main_piece_x_cor = p === 0 ? 0 : 7;\n  //pawns\n  for (let i = 0; i < 8; ++i) {\n    initialBoardState.push({\n      image: `assets/images/${type}_pawn.png`,\n      x: pawns_x_cor,\n      y: i,\n      type: \"pawn\",\n      team: teamType\n    });\n  }\n  //rooks\n  initialBoardState.push({\n    image: `assets/images/${type}_rook.png`,\n    x: main_piece_x_cor,\n    y: 0,\n    type: \"rook\",\n    team: teamType\n  });\n  initialBoardState.push({\n    image: `assets/images/${type}_rook.png`,\n    x: main_piece_x_cor,\n    y: 7,\n    type: \"rook\",\n    team: teamType\n  });\n\n  //knights\n  initialBoardState.push({\n    image: `assets/images/${type}_knight.png`,\n    x: main_piece_x_cor,\n    y: 1,\n    type: \"knight\",\n    team: teamType\n  });\n  initialBoardState.push({\n    image: `assets/images/${type}_knight.png`,\n    x: main_piece_x_cor,\n    y: 6,\n    type: \"knight\",\n    team: teamType\n  });\n\n  //bishops\n  initialBoardState.push({\n    image: `assets/images/${type}_bishop.png`,\n    x: main_piece_x_cor,\n    y: 2,\n    type: \"bishop\",\n    team: teamType\n  });\n  initialBoardState.push({\n    image: `assets/images/${type}_bishop.png`,\n    x: main_piece_x_cor,\n    y: 5,\n    type: \"bishop\",\n    team: teamType\n  });\n\n  //kings\n  initialBoardState.push({\n    image: `assets/images/${type}_king.png`,\n    x: main_piece_x_cor,\n    y: 4,\n    type: \"king\",\n    team: teamType\n  });\n\n  //queens\n  initialBoardState.push({\n    image: `assets/images/${type}_queen.png`,\n    x: main_piece_x_cor,\n    y: 3,\n    type: \"queen\",\n    team: teamType\n  });\n}\nexport default function GameBoard() {\n  _s();\n  const [activePiece, setActivePiece] = useState(null);\n  const [gridX, setGridX] = useState(0);\n  const [gridY, setGridY] = useState(0);\n  const [pieces, setPieces] = useState(initialBoardState);\n  const chessBoardRef = useRef(null);\n  const pawnPromotionModalRef = useRef(null);\n  const referee = new Referee();\n  const [promotionPawn, setPromotionPawn] = useState(null);\n  const [ourinCheck, setOurInCheck] = useState(false);\n  const [oppinCheck, setOppInCheck] = useState(false);\n  socket.on('serverToClient', data => {\n    setPieces(JSON.parse(data)[\"pieceArr\"]);\n  });\n  function grabPiece(e) {\n    const chessboard = chessBoardRef.current;\n    const element = e.target;\n    // e.setPointerCapture(e.pointerId);\n    if (element.classList.contains(\"chess-piece\") && chessboard) {\n      setGridX(Math.floor((e.clientX - chessboard.offsetLeft) / GRID_SIZE));\n      setGridY(Math.floor((e.clientY - chessboard.offsetTop) / GRID_SIZE));\n      const x = e.clientX;\n      const y = e.clientY;\n      element.style.position = \"absolute\";\n      element.style.left = `${x - GRID_SIZE / 2}px`;\n      element.style.top = `${y - GRID_SIZE / 2}px`;\n      setActivePiece(element);\n    }\n  }\n  function movePiece(e) {\n    const chessboard = chessBoardRef.current;\n    if (activePiece && chessboard) {\n      const minX = chessboard.offsetLeft;\n      const minY = chessboard.offsetTop;\n      const maxX = chessboard.offsetLeft + chessboard.clientWidth;\n      const maxY = chessboard.offsetTop + chessboard.clientHeight;\n      const x = e.clientX;\n      const y = e.clientY;\n      activePiece.style.position = \"absolute\";\n      if (x < minX) {\n        activePiece.style.left = `${minX - GRID_SIZE / 2}px`;\n      } else if (x > maxX) {\n        activePiece.style.left = `${maxX - GRID_SIZE / 2}px`;\n      } else activePiece.style.left = `${x - GRID_SIZE / 2}px`;\n      if (y < minY) {\n        activePiece.style.top = `${minY - GRID_SIZE / 2}px`;\n      } else if (y > maxY) {\n        activePiece.style.top = `${maxY - GRID_SIZE / 2}px`;\n      } else activePiece.style.top = `${y - GRID_SIZE / 2}px`;\n    }\n  }\n  function dropPiece(e) {\n    const chessboard = chessBoardRef.current;\n    if (activePiece && chessboard) {\n      const x = Math.floor((e.clientX - chessboard.offsetLeft) / GRID_SIZE);\n      const y = Math.floor((e.clientY - chessboard.offsetTop) / GRID_SIZE);\n      const currentPiece = pieces.find(p => p.y === gridX && p.x === gridY);\n      if (currentPiece) {\n        const validMove = referee.isValidMove(gridY, gridX, y, x, currentPiece.type, currentPiece.team, pieces);\n        const isEnPassantMove = referee.isEnPassantMove(gridY, gridX, y, x, currentPiece.type, currentPiece.team, pieces);\n        const pawnDirection = \"our\" === currentPiece.team ? 1 : -1;\n        if (isEnPassantMove) {\n          const updatedPieces = pieces.reduce((results, piece) => {\n            if (currentPiece === piece) {\n              piece.enPassant = false;\n              piece.x = y;\n              piece.y = x;\n              results.push(piece);\n            } else if (!(piece.x === y + pawnDirection && piece.y === x)) {\n              if (\"pawn\" === piece.type) piece.enPassant = false;\n              results.push(piece);\n            }\n            return results;\n          }, []);\n          setPieces(updatedPieces);\n          // here we are changing the state and we need to pass this info to the server.\n          socket.emit('clientToServer', JSON.stringify({\n            \"pieceArr\": updatedPieces,\n            \"team\": isBlack ? \"black\" : \"white\"\n          }));\n        } else {\n          if (validMove) {\n            //UPDATES THE PIECE POSITION\n            // AND IF A PIECE IS ATTACKED , REMOVES IT\n            if (\"pawn\" === currentPiece.type) {\n              const updatedPieces = pieces.reduce((results, piece) => {\n                if (currentPiece === piece) {\n                  if (piece.type === \"pawn\" && Math.abs(y - gridY) === 2) {\n                    //EN PASSANT ATTACKABLE PIECE\n                    piece.enPassant = true;\n                  } else {\n                    piece.enPassant = false;\n                  }\n                  piece.x = y;\n                  piece.y = x;\n                  if (0 === piece.x || 7 === piece.x) {\n                    setPromotionPawn(currentPiece);\n                    pawnPromotionModalRef.current.classList.remove('hidden');\n                  }\n                  results.push(piece);\n                } else if (!(piece.x === y && piece.y === x)) {\n                  if (\"pawn\" === piece.type) piece.enPassant = false;\n                  results.push(piece);\n                }\n                return results;\n              }, []);\n              setPieces(updatedPieces);\n              // here we are changing the state \n              socket.emit('clientToServer', JSON.stringify({\n                \"pieceArr\": updatedPieces,\n                \"team\": isBlack ? \"black\" : \"white\"\n              }));\n            } else if (\"knight\" === currentPiece.type || \"bishop\" === currentPiece.type || \"rook\" === currentPiece.type || \"queen\" === currentPiece.type || \"king\" === currentPiece.type) {\n              const updatedPieces = pieces.reduce((results, piece) => {\n                if (currentPiece === piece) {\n                  piece.x = y;\n                  piece.y = x;\n                  results.push(piece);\n                } else if (!(piece.x === y && piece.y === x)) {\n                  results.push(piece);\n                }\n                return results;\n              }, []);\n              setPieces(updatedPieces);\n              // here we are changing the state \n              socket.emit('clientToServer', JSON.stringify({\n                \"pieceArr\": updatedPieces,\n                \"team\": isBlack ? \"black\" : \"white\"\n              }));\n            }\n            if (referee.inCheck(pieces, \"our\")) {\n              setOurInCheck(true);\n              console.log(\"OMG !!! save our king it's attacked\");\n            }\n            if (referee.inCheck(pieces, \"opponent\")) {\n              setOppInCheck(true);\n              console.log(\"Hurray !!!  we attacked opponent's monarch\");\n            }\n          } else {\n            // RESETS  THE PIECE POSITION\n            activePiece.style.position = \"relative\";\n            activePiece.style.removeProperty('top');\n            activePiece.style.removeProperty('left');\n          }\n        }\n      }\n      setActivePiece(null);\n    }\n  }\n  function promotePawn(type) {\n    if (promotionPawn) {\n      const updatedPieces = pieces.reduce((results, piece) => {\n        if (promotionPawn === piece) {\n          piece.type = type;\n          piece.image = !isBlack ? piece.team === \"our\" ? `/assets/images/W_${type}.png` : `/assets/images/B_${type}.png` : piece.team === \"our\" ? `/assets/images/B_${type}.png` : `/assets/images/W_${type}.png`;\n        }\n        results.push(piece);\n        return results;\n      }, []);\n      setPieces(updatedPieces);\n      socket.emit('clientToServer', JSON.stringify({\n        \"pieceArr\": updatedPieces,\n        \"team\": isBlack ? \"black\" : \"white\"\n      }));\n      pawnPromotionModalRef.current.classList.add('hidden');\n    }\n  }\n  function promotionTeamType() {\n    if (promotionPawn) return !isBlack ? promotionPawn.team === \"our\" ? \"W\" : \"B\" : promotionPawn.team === \"our\" ? \"B\" : \"W\";\n  }\n  let board = [];\n  for (let i = 0; i < verticalAxis.length; ++i) {\n    for (let j = 0; j < horizontalAxis.length; ++j) {\n      let image = undefined;\n      pieces.forEach(p => {\n        if (p.x === i && p.y === j) image = p.image;\n      });\n      // board.push(<div className='coordinates'>{`x=${i},y = ${j}`}</div>)\n      board.push( /*#__PURE__*/_jsxDEV(Tile, {\n        num: i * i + j,\n        image: image\n      }, `${i}${j}`, false, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 18\n      }, this));\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"pawn-promotion-modal\",\n      className: \"hidden\",\n      ref: pawnPromotionModalRef,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-body\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          onClick: () => promotePawn(\"rook\"),\n          src: `/assets/images/${promotionTeamType()}_rook.png`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          onClick: () => promotePawn(\"queen\"),\n          src: `/assets/images/${promotionTeamType()}_queen.png`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 264,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          onClick: () => promotePawn(\"knight\"),\n          src: `/assets/images/${promotionTeamType()}_knight.png`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n          onClick: () => promotePawn(\"bishop\"),\n          src: `/assets/images/${promotionTeamType()}_bishop.png`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      onPointerMove: e => movePiece(e),\n      onPointerDown: e => grabPiece(e),\n      onPointerUp: e => dropPiece(e),\n      id: \"gameboard\",\n      ref: chessBoardRef,\n      children: board\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(GameBoard, \"VLgFsfxR8olLIVpUoikKSh8kX5U=\");\n_c = GameBoard;\nvar _c;\n$RefreshReg$(_c, \"GameBoard\");","map":{"version":3,"names":["React","useRef","useState","Tile","Referee","GRID_SIZE","horizontalAxis","verticalAxis","io","room","prompt","team","socket","piece","image","String","x","Number","y","type","enPassant","Boolean","initialBoardState","isBlack","p","teamType","pawns_x_cor","main_piece_x_cor","i","push","GameBoard","activePiece","setActivePiece","gridX","setGridX","gridY","setGridY","pieces","setPieces","chessBoardRef","pawnPromotionModalRef","referee","promotionPawn","setPromotionPawn","ourinCheck","setOurInCheck","oppinCheck","setOppInCheck","on","data","JSON","parse","grabPiece","e","chessboard","current","element","target","classList","contains","Math","floor","clientX","offsetLeft","clientY","offsetTop","style","position","left","top","movePiece","minX","minY","maxX","clientWidth","maxY","clientHeight","dropPiece","currentPiece","find","validMove","isValidMove","isEnPassantMove","pawnDirection","updatedPieces","reduce","results","emit","stringify","abs","remove","inCheck","console","log","removeProperty","promotePawn","add","promotionTeamType","board","length","j","undefined","forEach"],"sources":["C:/Users/think/Desktop/Projects/Chess Project/frontend/chess-frontend/src/Components/GameBoard.jsx"],"sourcesContent":["import React, { useRef, useState } from 'react'\r\nimport './GameBoard.css'\r\nimport Tile from './Tile';\r\nimport Referee from './Referee';\r\nimport { GRID_SIZE, horizontalAxis, verticalAxis } from '../constants';\r\nimport  io  from 'socket.io-client';\r\n\r\nconst room = prompt('Enter room');\r\n// const room = \"default\";\r\n\r\nconst team = prompt(`Enter 'B' for black  or 'W' for white`);\r\n\r\nconst socket = io(`ws://192.168.29.13:8085/?room=${room}`);\r\n\r\nexport let piece = {\r\n  image: String,\r\n  x: Number,\r\n  y: Number,\r\n  type: String,\r\n  team: String,\r\n  enPassant: Boolean\r\n}\r\n\r\n// array which holds the information regarding initial chess pieces and their \r\nconst initialBoardState = [];\r\nexport const isBlack = team==='B'?true:false;\r\n\r\n\r\n// here we init the board state on game start\r\nfor (let p = 0; p < 2; p++) {\r\n  const teamType = (p === 0) ? \"opponent\" : \"our\";\r\n  const type = (!isBlack) ? ((p === 0) ? \"B\" : \"W\"):((p === 0) ? \"W\" : \"B\");\r\n    const pawns_x_cor = (p === 0) ? 1 : 6;\r\n    const main_piece_x_cor = (p === 0) ? 0 : 7;\r\n    //pawns\r\n    for (let i = 0; i < 8; ++i) {\r\n      initialBoardState.push({ image: `assets/images/${type}_pawn.png`, x: pawns_x_cor, y: i, type: \"pawn\", team: teamType })\r\n    }\r\n    //rooks\r\n    initialBoardState.push({ image: `assets/images/${type}_rook.png`, x: main_piece_x_cor, y: 0, type: \"rook\", team: teamType })\r\n    initialBoardState.push({ image: `assets/images/${type}_rook.png`, x: main_piece_x_cor, y: 7, type: \"rook\", team: teamType })\r\n  \r\n    //knights\r\n    initialBoardState.push({ image: `assets/images/${type}_knight.png`, x: main_piece_x_cor, y: 1, type: \"knight\", team: teamType })\r\n    initialBoardState.push({ image: `assets/images/${type}_knight.png`, x: main_piece_x_cor, y: 6, type: \"knight\", team: teamType })\r\n  \r\n    //bishops\r\n    initialBoardState.push({ image: `assets/images/${type}_bishop.png`, x: main_piece_x_cor, y: 2, type: \"bishop\", team: teamType })\r\n    initialBoardState.push({ image: `assets/images/${type}_bishop.png`, x: main_piece_x_cor, y: 5, type: \"bishop\", team: teamType })\r\n  \r\n    //kings\r\n    initialBoardState.push({ image: `assets/images/${type}_king.png`, x: main_piece_x_cor, y: 4, type: \"king\", team: teamType })\r\n  \r\n    //queens\r\n    initialBoardState.push({ image: `assets/images/${type}_queen.png`, x: main_piece_x_cor, y: 3, type: \"queen\", team: teamType })\r\n \r\n\r\n}\r\n\r\n\r\nexport default function GameBoard() {\r\n  const [activePiece, setActivePiece] = useState(null);\r\n  const [gridX, setGridX] = useState(0);\r\n  const [gridY, setGridY] = useState(0);\r\n  const [pieces, setPieces] = useState(initialBoardState);\r\n  const chessBoardRef = useRef(null);\r\n  const pawnPromotionModalRef = useRef(null);\r\n  const referee = new Referee();\r\n  const [promotionPawn,setPromotionPawn] = useState(null);\r\n  const [ourinCheck,setOurInCheck] = useState(false);\r\n  const [oppinCheck,setOppInCheck] = useState(false);\r\n\r\n\r\n  socket.on('serverToClient',(data)=>{\r\n    setPieces(JSON.parse(data)[\"pieceArr\"]);\r\n  }) \r\n\r\n  function grabPiece(e) {\r\n    const chessboard = chessBoardRef.current;\r\n    const element = (e.target);\r\n    // e.setPointerCapture(e.pointerId);\r\n    if (element.classList.contains(\"chess-piece\") && chessboard) {\r\n      setGridX(Math.floor((e.clientX - chessboard.offsetLeft) / GRID_SIZE));\r\n      setGridY(Math.floor((e.clientY - chessboard.offsetTop) / GRID_SIZE));\r\n      const x = e.clientX;\r\n      const y = e.clientY;\r\n      element.style.position = \"absolute\";\r\n      element.style.left = `${x - GRID_SIZE / 2}px`;\r\n      element.style.top = `${y - GRID_SIZE / 2}px`;\r\n      setActivePiece(element); \r\n    }\r\n  }\r\n\r\n  function movePiece(e) {\r\n    const chessboard = chessBoardRef.current;\r\n    if (activePiece && chessboard) {\r\n      const minX = chessboard.offsetLeft;\r\n      const minY = chessboard.offsetTop;\r\n      const maxX = chessboard.offsetLeft + chessboard.clientWidth;\r\n      const maxY = chessboard.offsetTop + chessboard.clientHeight;\r\n      const x = e.clientX;\r\n      const y = e.clientY;\r\n      activePiece.style.position = \"absolute\";\r\n\r\n      if (x < minX) {\r\n        activePiece.style.left = `${minX - GRID_SIZE / 2}px`;\r\n      }\r\n      else if (x > maxX) {\r\n        activePiece.style.left = `${maxX - GRID_SIZE / 2}px`;\r\n      }\r\n      else activePiece.style.left = `${x - GRID_SIZE / 2}px`;\r\n\r\n      if (y < minY) {\r\n        activePiece.style.top = `${minY - GRID_SIZE / 2}px`;\r\n      }\r\n      else if (y > maxY) {\r\n        activePiece.style.top = `${maxY - GRID_SIZE / 2}px`;\r\n\r\n      }\r\n      else activePiece.style.top = `${y - GRID_SIZE / 2}px`;\r\n    }\r\n  }\r\n\r\n\r\n  function dropPiece(e) {\r\n    const chessboard = chessBoardRef.current;\r\n    if (activePiece && chessboard) {\r\n      const x = Math.floor((e.clientX - chessboard.offsetLeft) / GRID_SIZE);\r\n      const y = Math.floor((e.clientY - chessboard.offsetTop) / GRID_SIZE);\r\n      const currentPiece = pieces.find(p => p.y === gridX && p.x === gridY);\r\n      if (currentPiece) {\r\n        const validMove = referee.isValidMove(gridY, gridX, y, x, currentPiece.type, currentPiece.team, pieces);\r\n        const isEnPassantMove = referee.isEnPassantMove(gridY, gridX, y, x, currentPiece.type, currentPiece.team, pieces);\r\n        const pawnDirection = \"our\" === currentPiece.team ? 1 : -1;\r\n        if (isEnPassantMove) {\r\n          const updatedPieces = pieces.reduce((results, piece) => {\r\n            if (currentPiece === piece) {\r\n              piece.enPassant = false;\r\n              piece.x = y;\r\n              piece.y = x;\r\n              results.push(piece);\r\n            }\r\n            else if (!(piece.x === y + pawnDirection && piece.y === x)) {\r\n              if (\"pawn\" === piece.type)\r\n                piece.enPassant = false;\r\n              results.push(piece);\r\n            }\r\n            return results;\r\n          }, []);\r\n          setPieces(updatedPieces);\r\n          // here we are changing the state and we need to pass this info to the server.\r\n          socket.emit('clientToServer',JSON.stringify({\"pieceArr\":updatedPieces , \"team\":isBlack?\"black\":\"white\"}));\r\n        }\r\n        else {\r\n          if (validMove) {\r\n            //UPDATES THE PIECE POSITION\r\n            // AND IF A PIECE IS ATTACKED , REMOVES IT\r\n            if (\"pawn\" === currentPiece.type) {\r\n              const updatedPieces = pieces.reduce((results, piece) => {\r\n                if (currentPiece === piece) {\r\n                  if (piece.type === \"pawn\" && Math.abs(y - gridY) === 2) {\r\n                    //EN PASSANT ATTACKABLE PIECE\r\n                    piece.enPassant = true;\r\n                  }\r\n                  else {\r\n                    piece.enPassant = false;\r\n                  }\r\n                  piece.x = y;\r\n                  piece.y = x;\r\n                  if(0 === piece.x || 7 === piece.x)\r\n                  {\r\n                    setPromotionPawn(currentPiece);\r\n                    pawnPromotionModalRef.current.classList.remove('hidden');\r\n                  }\r\n                  results.push(piece);\r\n                }\r\n                else if (!(piece.x === y && piece.y === x)) {\r\n                  if (\"pawn\" === piece.type)\r\n                    piece.enPassant = false;\r\n                  results.push(piece);\r\n                }\r\n                return results;\r\n              }, []);\r\n              setPieces(updatedPieces);\r\n          // here we are changing the state \r\n          socket.emit('clientToServer',JSON.stringify({\"pieceArr\":updatedPieces , \"team\":isBlack?\"black\":\"white\"}));\r\n            }\r\n            else if (\"knight\" === currentPiece.type || \"bishop\" === currentPiece.type || \"rook\" === currentPiece.type || \"queen\" === currentPiece.type || \"king\" === currentPiece.type) {\r\n              const updatedPieces = pieces.reduce((results, piece) => {\r\n                if (currentPiece === piece) {\r\n                  piece.x = y;\r\n                  piece.y = x;\r\n                  results.push(piece);\r\n                }\r\n                else if (!(piece.x === y && piece.y === x)) {\r\n                  results.push(piece);\r\n                }\r\n                return results;\r\n              }, []);\r\n              setPieces(updatedPieces);\r\n          // here we are changing the state \r\n          socket.emit('clientToServer',JSON.stringify({\"pieceArr\":updatedPieces , \"team\":isBlack?\"black\":\"white\"}));\r\n\r\n            }\r\n            if (referee.inCheck(pieces, \"our\")) {\r\n              setOurInCheck(true);\r\n              console.log(\"OMG !!! save our king it's attacked\");\r\n            }\r\n            if (referee.inCheck(pieces, \"opponent\")) {\r\n              setOppInCheck(true);\r\n              console.log(\"Hurray !!!  we attacked opponent's monarch\");\r\n            }\r\n          }\r\n          else {\r\n            // RESETS  THE PIECE POSITION\r\n            activePiece.style.position = \"relative\";\r\n            activePiece.style.removeProperty('top');\r\n            activePiece.style.removeProperty('left');\r\n          }\r\n        }\r\n\r\n      }\r\n      setActivePiece(null);\r\n    }\r\n  }\r\n\r\n  function promotePawn(type)\r\n  {\r\n    if (promotionPawn) {\r\n      const updatedPieces = pieces.reduce((results, piece) => {\r\n        if (promotionPawn === piece) {\r\n          piece.type = type;\r\n          piece.image = (!isBlack) ?  ((piece.team === \"our\") ? `/assets/images/W_${type}.png`:`/assets/images/B_${type}.png`) : ((piece.team === \"our\") ? `/assets/images/B_${type}.png`:`/assets/images/W_${type}.png`);\r\n        }\r\n        results.push(piece);\r\n        return results;\r\n      }, []);\r\n    setPieces(updatedPieces);\r\n    socket.emit('clientToServer',JSON.stringify({\"pieceArr\":updatedPieces , \"team\":isBlack?\"black\":\"white\"}));\r\n    pawnPromotionModalRef.current.classList.add('hidden');\r\n    }\r\n  }\r\n\r\n  function promotionTeamType()\r\n  {\r\n    if(promotionPawn)\r\n    return (!isBlack)?(promotionPawn.team === \"our\" ? \"W\" : \"B\"):(promotionPawn.team === \"our\" ? \"B\" : \"W\");\r\n  }\r\n\r\n  let board = [];\r\n  for (let i = 0; i < verticalAxis.length; ++i) {\r\n    for (let j = 0; j < horizontalAxis.length; ++j) {\r\n      let image = undefined;\r\n      pieces.forEach(p => { if (p.x === i && p.y === j) image = p.image });\r\n      // board.push(<div className='coordinates'>{`x=${i},y = ${j}`}</div>)\r\n      board.push(<Tile key={`${i}${j}`} num={i * i + j} image={image} />);\r\n    }\r\n  }\r\n  return (\r\n    <>\r\n      <div id=\"pawn-promotion-modal\" className='hidden' ref={pawnPromotionModalRef}>\r\n        <div className='modal-body' >\r\n          <img onClick={() => promotePawn(\"rook\")} src={`/assets/images/${promotionTeamType()}_rook.png`} />\r\n          <img onClick={() => promotePawn(\"queen\")} src={`/assets/images/${promotionTeamType()}_queen.png`} />\r\n          <img onClick={() => promotePawn(\"knight\")} src={`/assets/images/${promotionTeamType()}_knight.png`} />\r\n          <img onClick={() => promotePawn(\"bishop\")} src={`/assets/images/${promotionTeamType()}_bishop.png`} />\r\n        </div>\r\n\r\n      </div>\r\n      <div onPointerMove={e => movePiece(e)} onPointerDown={e => grabPiece(e)} onPointerUp={e => dropPiece(e)} id=\"gameboard\" ref={chessBoardRef}>\r\n        {board}\r\n      </div>\r\n    </>\r\n\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}